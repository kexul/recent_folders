# Windows 最近访问文件夹查看器 🚀

一个强大且智能的Windows最近访问文件夹管理工具，让您快速找到和管理最近使用过的文件夹，现在带有AI智能标签和分类功能！

## ✨ 核心特性

### 🧠 **智能标签系统**（新功能）
- **自动分类**：AI智能识别文件夹用途，自动生成标签
- **智能注释**：根据路径、内容、使用频率自动生成描述性注释
- **快捷过滤**：一键筛选开发、工作、学习、多媒体等不同类型文件夹
- **标签格式**：`[分类] 标签1 | 标签2 | 标签3` 清晰易懂

### 🎯 **智能识别能力**
- **开发项目**：识别代码仓库、编程项目、开发工具目录
- **工作文档**：识别办公文档、会议资料、商务文件夹
- **学习资料**：识别课程资料、教程、学术文档
- **多媒体文件**：识别照片、视频、音频、设计文件
- **使用频率**：自动标记"常用"、"经常"使用的文件夹
- **时间标签**：标记"今日"、"最近"、"本周"访问的文件夹

### 🔍 **智能搜索与过滤**
- **实时搜索**：输入时实时过滤结果
- **多字段搜索**：同时搜索路径和智能标签内容
- **分类快捷键**：点击分类按钮快速筛选特定类型文件夹
- **智能匹配**：支持模糊匹配和关键词搜索

### 🚀 **快速操作**
- **双击智能**：点击路径打开文件夹，点击注释编辑注释
- **右键增强**：新增"自动生成注释"、"重新生成所有标签"选项
- **键盘导航**：全键盘操作支持，快捷键丰富
- **批量处理**：一键重新生成所有智能标签

### 📝 **增强的注释管理**
- **混合模式**：支持手动注释和自动生成注释并存
- **注释优先级**：手动注释不会被自动注释覆盖
- **批量管理**：方便地管理和重新生成所有标签
- **格式化显示**：自动注释采用统一格式，易于识别

### 👀 **文件预览**
- **双栏布局**：左侧文件夹列表，右侧文件预览
- **实时预览**：选中文件夹时自动显示内容
- **性能优化**：大文件夹快速加载（限制显示数量）
- **文件操作**：直接双击打开文件

### ⚡ **系统集成**
- **系统托盘**：最小化到托盘，不占用任务栏
- **全局快捷键**：Ctrl+9 快速呼出窗口
- **开机启动**：可设置开机自动启动（需手动配置）
- **后台处理**：智能标签生成在后台进行，不影响使用

## 🎯 **智能分类详解**

### 自动识别的文件夹类型：

1. **开发项目** 🖥️
   - 包含：project, code, dev, src, github, programming等关键词
   - 文件类型：.py, .js, .java, .cpp, .cs等代码文件

2. **工作文档** 💼
   - 包含：work, office, business, document, meeting等关键词
   - 文件类型：.doc, .pdf, .ppt, .xlsx等办公文件

3. **学习资料** 📚
   - 包含：study, learn, course, education, school等关键词
   - 用途：课程资料、教程、学术研究

4. **多媒体文件** 🎨
   - 包含：photo, video, music, media, gallery等关键词
   - 文件类型：.jpg, .mp4, .mp3等多媒体文件

5. **系统文件** ⚙️
   - 包含：system, windows, appdata, config等关键词
   - 系统级目录和配置文件

6. **下载临时** 📥
   - 包含：download, temp, cache, installer等关键词
   - 临时文件和下载目录

## 📋 **系统要求**

- Windows 7/8/10/11
- Python 3.7+
- 所需依赖包（见 requirements.txt）

## 🚀 **安装使用**

### 方法一：直接运行（推荐）
```bash
# 克隆仓库
git clone [repository-url]
cd recent-folders-viewer

# 安装依赖
pip install -r requirements.txt

# 运行程序
python recent_folders_viewer.py
```

### 方法二：打包为可执行文件
```bash
# 安装 PyInstaller
pip install pyinstaller

# 打包程序
pyinstaller --windowed --onefile --icon=app_icon.ico recent_folders_viewer.py

# 运行生成的exe文件
dist/recent_folders_viewer.exe
```

## 🎯 **使用指南**

### 基本操作
1. **启动程序**：运行后自动扫描并生成智能标签
2. **智能分类**：点击分类按钮快速筛选文件夹类型
3. **搜索过滤**：在搜索框中输入关键词进行过滤
4. **打开文件夹**：双击路径列或按回车键
5. **编辑注释**：双击注释列或右键选择编辑

### 智能功能使用
- **自动标签生成**：程序启动3秒后自动在后台生成
- **手动生成标签**：右键选择"自动生成注释"为单个文件夹生成
- **批量重新生成**：右键选择"重新生成所有标签"
- **分类筛选**：点击"开发"、"工作"、"学习"等按钮快速筛选

### 高级功能
- **系统托盘**：按ESC键或点击关闭按钮隐藏到托盘
- **全局快捷键**：任何时候按 Ctrl+9 快速显示窗口
- **键盘导航**：
  - `Ctrl+F`：快速定位到搜索框
  - `↑↓`：在文件夹列表中导航
  - `←→`：在左右面板间切换
  - `Enter`：打开选中的文件夹或文件
  - `ESC`：隐藏到系统托盘

### 右键菜单功能
- **编辑注释**：手动编辑文件夹注释
- **删除注释**：删除文件夹的注释
- **自动生成注释**：为单个文件夹生成智能标签（新功能）
- **重新生成所有标签**：批量重新生成智能标签（新功能）
- **打开文件夹**：在文件管理器中打开
- **复制路径**：复制文件夹路径到剪贴板

## ⚙️ **配置文件**

程序会在用户目录下创建配置文件夹：
```
~/.recent_folders_viewer/
├── config.json          # 主配置文件（包含智能标签数据）
```

配置文件包含：
- 文件夹访问历史和频率统计
- 用户自定义的文件夹注释
- 自动生成的智能标签和分类
- 程序设置和偏好

## 🔧 **开发相关**

### 项目结构
```
recent-folders-viewer/
├── recent_folders_viewer.py    # 主程序文件（包含AI智能标签功能）
├── requirements.txt            # 依赖列表
├── README.md                   # 说明文档
├── app_icon_16.png            # 16x16 图标
├── app_icon_32.png            # 32x32 图标
├── app_icon_64.png            # 64x64 图标
└── app_icon.ico               # Windows图标文件
```

### 智能标签算法
程序采用多维度分析算法：
1. **路径关键词分析**：基于文件夹路径中的关键词
2. **内容快速扫描**：分析文件夹中前几个文件的类型
3. **使用频率分析**：根据历史访问频率生成标签
4. **时间维度分析**：根据访问时间生成时间标签
5. **综合评分系统**：多个维度加权计算最终分类

### 主要依赖
- `tkinter`：GUI界面框架
- `pywin32`：Windows系统API访问
- `pyperclip`：剪贴板操作
- `pystray`：系统托盘支持
- `keyboard`：全局快捷键
- `Pillow`：图像处理

## 🐛 **故障排除**

### 常见问题

**Q: 智能标签没有生成**
A: 智能标签在程序启动3秒后在后台生成，请稍等片刻。也可以右键选择"重新生成所有标签"手动触发。

**Q: 自动注释覆盖了我的手动注释**
A: 程序会保护手动注释，只有以"["开头的自动注释才会被重新生成。

**Q: 分类按钮点击没有效果**
A: 确保文件夹数据已加载完成，可以尝试刷新列表或重新生成智能标签。

**Q: 程序启动后没有显示任何文件夹**
A: 这通常是因为Windows Recent文件夹为空或权限问题。尝试：
1. 打开一些文件夹，让Windows记录访问历史
2. 检查程序是否有足够的权限访问系统文件
3. 重启程序并等待加载完成

**Q: 某些文件夹显示为灰色**
A: 灰色表示文件夹已被删除或移动，但仍在访问历史中

**Q: 全局快捷键不工作**
A: 确保：
1. 程序正在运行（可能在系统托盘中）
2. 没有其他程序占用相同的快捷键
3. 程序有足够的权限注册全局快捷键

## 🎉 **更新日志**

### v2.0 - 智能标签版本
- ✨ 新增AI智能标签自动生成功能
- 🏷️ 新增文件夹智能分类系统
- 🔍 新增快捷分类过滤按钮
- 📝 增强右键菜单功能
- 🧠 智能识别开发、工作、学习等文件夹类型
- ⏰ 自动生成基于使用频率和时间的标签
- 🎯 优化搜索和过滤体验

### v1.0 - 基础版本
- 📁 基本的最近文件夹查看功能
- 🔍 搜索和过滤功能
- 📝 手动注释功能
- 👀 文件预览功能

## 📄 **许可证**

MIT License - 详见 LICENSE 文件

## 🤝 **贡献**

欢迎提交Issue和Pull Request！

### 贡献指南
1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 创建 Pull Request

## 📞 **支持**

如有问题或建议，请：
1. 查看本 README 的故障排除部分
2. 搜索现有的 Issues
3. 创建新的 Issue 详细描述问题

---

**享受AI驱动的智能文件夹管理体验！** 🎉